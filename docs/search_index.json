[
["index.html", "Métodos quantitativos em Psicologia com R e Rstudio Capítulo 1 Introdução 1.1 Objetivo 1.2 Bases 1.3 Pacotes e sintaxes 1.4 Aspectos gerais", " Métodos quantitativos em Psicologia com R e Rstudio Luis Anunciação (PUC-Rio), PhD 2020-04-09 Capítulo 1 Introdução Aprender estatística e análise de dados é uma das tarefas mais importantes e desafiadoras que existe no meio acadêmico, especialmente às disciplinas agrupadas em ciências humanas, como Psicologia. Por consequência, ensinar ambas as matérias também impõe um desafio enorme, mas necessário. Por diversas razões, as pesquisas feitas em Psicologia apresentam muitas informações misturadas e sobrepostas e a utilização da estatística é fundamental para conseguir separar e filtrar àquelas informações que temos interesse (sinal) daquelas que apenas distorcem estas primeiras (ruído). 1.1 Objetivo Talvez uma das coisas mais importantes para se ter em mente neste livro é que ele foi, propositalmente, escrito de forma pouco linear. Apesar de toda metodologia estatística ser apresentada de forma estruturada, os capítulos podem também ser acessados apenas para responder questões específicas, particulares e pontuais. Assim, penso que o livro consegue atender tanto aqueles leitores com interesse em ler a obra por completo, como aqueles que buscam apenas informações mais específicas de uma das partes. Evidentemente, como muitos testes estatísticos podem ser entendidos como casos particulares de outros, alguns fragmentos que podem parecer destoantes em alguns capítulos tornam-se fáceis e acessíveis àqueles que se dispuserem a fazer uma releitura após ter terminado uma leitura integral do livro. Para ilustrar, o capítulo sobre o Teste T expõe uma pequena parte sobre modelos de regressão, conteúdo que somente é abordado posteriormente. Se em um primeiro momento isso pode gerar alguma (pequena) confusão, a releitura do capítulo após o término da sequência do livro frequentemente se traduz em um resultado mais positivo e uma melhor percepção da integração que existe entre diferentes modelos estatísticos. 1.2 Bases Todas as bases de dados utilizadas neste livro são frutos de pesquisas empíricas que apresentam artigos publicados. Uma vez que o objetivo de um livro é diferente do objetivo da publicação de um artigo, alguns ajustes foram feitos às bases para torná-las mais acessíveis. Nenhuma alteração foi realizada nos dados, mas apenas em mudanças em relação a nomes de variáveis e quantidade de vetores. 1.3 Pacotes e sintaxes Este livro utiliza majoritariamente o ambiente tidyverse para realização das análises. Entretanto, sempre que necessário, funções R-base e uso de outros pacotes serão utilizados. Toda sintaxe utilizada no livro está disponível gratuitamente neste (GitHub)[https://github.com/anovabr/mqt]. 1.4 Aspectos gerais Conforme já explicitado, a estatística pode ser dividida em duas áreas interligadas: estatística descritiva e estatística inferencial. O objetivo da estatística descritiva é apresentar sínteses e resumos dos resultados a partir de gráficos e tabelas. Não é intenção dessa área fazer generalizações ou extrapolar os resultados obtidos em uma pesquisa a pessoas não investigadas durante a coleta de dados. Por contraste, a estatística inferencial visa extrapolar os dados e fazer generalizações que toquem toda população de onde aquela mostra foi retirada e é representativa. Dessa maneira, o principal objetivo da estatística inferencial é, de fato, fazer inferências. Apesar de livros e aulas unirem ambas as áreas da estatística, alguns pontos merecem destaque, que são: A estatística descritiva surgiu antes que a inferencial. A etimologia da palavra talvez ajude a entender, uma vez que estatística vem da palavra estado e este sempre teve interesse em saber quantos eram os cidadãos de um determinado local para, entre outras atividades, taxá-los. Dessa maneira, aspectos descritivos antecedem os inferenciais. Por sua vez, a estatística inferencial guarda origem e proximidade com a teoria dos jogos e, consequentemente, isso ajuda a entender o motivo pelo qual a maioria dos exemplos inferenciais envolvem jogos de azar. A estatística tem duas “escolas” ou “formas de pensamento”. A estatística frequentista e a estatística bayesiana. Aspectos fundamentais que tocam à definição de probabilidade são diferentes, bem como a definição de dados e parâmetros também o são. Pela perspectiva histórica, a estatística bayesiana é mais antiga que a frequentista. No entanto, se for comparado a proporção de uso entre os pesquisadores, a estatística frequentista é ainda a mais frequente e justifica a ênfase deste livro nesta área. A relação entre estatística e Machine Learning (ML) é relativamente recente. Apesar de grande interface, e do fato que as análises realizadas em estatística e ML encontram resultados virtualmente idênticos, as áreas têm objetivos diferentes. Ainda sob perspectiva histórica, a estatística, como uma área do conhecimento, é anterior à ML e, também por isso, justifica a ênfase do livro. "],
["estatística-descritiva.html", "Capítulo 2 Estatística Descritiva 2.1 Pesquisa 2.2 Condições gerais 2.3 Verbos do dplyr 2.4 Tabelas 2.5 Gráficos 2.6 1 variável discreta 2.7 1 variável contínua 2.8 2 variáveis com VI discreta (e VD contínua) 2.9 2 variáveis com VI contínua (e VD contínua) 2.10 Outros gráficos e configurações 2.11 Resumo", " Capítulo 2 Estatística Descritiva Objetivos do capítulo 1. Apresentar tabelas e gráficos 2. Introduzir os verbos do dplyr e funções do ggplot. 3. Oferecer convenções ou regras gerais para criação de gráficos 2.1 Pesquisa Base: Dados - Brasil e espanha fusionados Neste capítulo (e em alguns outros), vamos utilizar a pesquisa intitulada “Sintomas de depressão e ansiedade em universitários espanhóis, portugueses e brasileiros”, com previsão de publicação pela Revista Psicologia: Teoria e Pesquisa em 2020. Nessa pesquisa, sou o coautor e o pesquisador responsável para correspondência. O objetivo da pesquisa foi explorar sintomas de ansiedade e depressão em universitários, bem como investigar possíveis relações entre tais traços latentes e fatores sociodemográficos. Um diferencial importante do trabalho foi a seleção amostral. Partiu-se de uma amostra estratificada (probabilística) dos estudantes de três universidades, PUC-Rio (Brasil), Universidade de Extremadura (Espanha) e Universidade de Coimbra (Portugal). Isso permitiu ter maior validade externa dos resultados. 2.2 Condições gerais Todo documento acadêmico e científico é composto de aspectos textuais, tabulares e gráficos que devem caminhar na mesma direção e serem sempre associados às perguntas e objetivos traçados na pesquisa. É fácil perceber, dessa maneira, que a parte principal de qualquer trabalho acadêmico não são necessariamente os aspectos estatísticos, mas sim os objetivos e as possíveis hipóteses investigadas pelos pesquisadores. A estatística, neste sentido, é uma valiosa ferramenta de trabalho (ou uma atividade de meio) para que as perguntas sejam respondidas de forma adequada e válida. Frequentemente, as primeiras análises descritivas começam pela apresentação de tabelas e gráficos. Da mesma forma que a construção de um prédio depende que andaimes sejam colocados, um relatório técnico depende dessas condições. Ainda neste sentido, da mesma maneira que a conclusão do prédio cursa com a retirada dos andaimes, é bem possível que as versões finais de artigos científicos ou relatórios aproveitem apenas parte dos gráficos e tabelas desenvolvidos. Dito isso, o R e seus pacotes oferecem excelentes ferramentas para aspectos descritivos. No entanto, algumas apresentações relativamente simples frequentemente trazem uma dificuldade computacional intensa, o que pode gerar alguma desvantagem na utilização do R para tais apresentações quando comparados com programas mais acessíveis, como o Excel. No entanto, apesar dessa condição, a relação entre dificuldade e complexidade favorece o R àquelas tarefas mais complicadas, como realizar análises inferenciais e psicométricas, como apresentado a seguir. 2.3 Verbos do dplyr O dplyr funciona de maneira muito intuitiva. O padrão original do R considera que as operações são realizadas a partir de uma lógica do tipo verbo(sujeito, complemento) enquanto o ambiente tidyverse opta por sujeito %&gt;% verbo(complemento), tornando-se o ato de programar mais natural e associado à maneira que organizamos as ideias. Os verbos principais do pacote estão listados na tabela a seguir e as sintaxes deixadas no decorrer deste capítulo (e do livro) permitem uma melhor apreensão das funcionalidades. É importante lembrar que, em alguns momentos, em função da praticidade computacional, algumas sintaxes vão contar com o formato base do R. Verbo Ação glimpse Inspeciona os dados count Conta os níveis de uma variável select seleciona uma variável específica filter Filtra os resultados por um nível específico de uma variável group_by Agrupa os resultados por níveis de uma variávei específica summarise Apresenta sumários (com medidas estatísticas) mutate Cria novas variáveis ou altera as existentes arrange Organiza a apresentação dos resultados left_join Junta bases ou colunas pivot_longer Transforma uma base larga em longa pivot_wider Transforma uma base longa em larga É também importante ficar atento às atualizações do dplyr e do sistema tidyverse como um todo. Eventualmente, mudanças podem ocorrer e impossibilitar (ou dificultar) a reprodução de rotinas antigas. O site é o local ideal para acompanhar as atualizações. 2.4 Tabelas Tabelas apresentam os sumários informacionais de uma pesquisa de maneira reunida e objetiva. Como os verbos do dplyr possibilitam que os mesmos resultados sejam encontrados por vias diferentes, os códigos a seguir tentarão manter uma uniformidade lógica. Em alguns momentos, para ampliar as possibilidades de codificação, sintaxes extras serão oferecidas. A tabela a seguir apresenta a quantidade de participantes em cada país. Dataset %&gt;% group_by(country) %&gt;% summarise(n=n()) %&gt;% kable(digits = 2) %&gt;% kable_styling(bootstrap_options = c(&quot;striped&quot;, &quot;hover&quot;, &quot;condensed&quot;)) country n Espanha 1216 Portugal 426 Brasil 315 É também possível adicionar proporções relativas à tabela, o que é uma escolha adequada para apresentação dos resultados. Dataset %&gt;% group_by(country) %&gt;% summarise(n=n(), Prop = n/nrow(.)) %&gt;% kable(digits = 2) %&gt;% kable_styling(bootstrap_options = c(&quot;striped&quot;, &quot;hover&quot;, &quot;condensed&quot;)) country n Prop Espanha 1216 0.62 Portugal 426 0.22 Brasil 315 0.16 O pacote janitor oferece complementos úteis à família tidyverse e um deles justamente adiciona os totais, de maneira mais rápida e, em função disso, os exemplos também irão acessar as funções deste pacote. Dataset %&gt;% tabyl(country) %&gt;% adorn_totals() %&gt;% kable(digits = 2) %&gt;% kable_styling(bootstrap_options = c(&quot;striped&quot;, &quot;hover&quot;, &quot;condensed&quot;)) country n percent Espanha 1216 0.62 Portugal 426 0.22 Brasil 315 0.16 Total 1957 1.00 O mesmo que foi realizado com os países, pode também ser realizado com o sexo do participante. Dataset %&gt;% tabyl(sex) %&gt;% adorn_totals() %&gt;% kable(digits = 2) %&gt;% kable_styling(bootstrap_options = c(&quot;striped&quot;, &quot;hover&quot;, &quot;condensed&quot;)) sex n percent valid_percent M 736 0.38 0.38 F 1214 0.62 0.62 NA 7 0.00 NA Total 1957 1.00 1.00 A adição do argumento para filtrar os participantes com dados ausentes sobre sexo auxilia a apresentar melhor os resultados. É importante atentar que essa análise tem finalidade descritiva e que omitir a apresentação de variáveis ausentes não significa excluir ou remover os participantes das análises que serão feitas posteriormente. Somente em possibilidades remotas se retira participantes das análises de maneira definitiva. Dataset %&gt;% filter(!is.na(sex)) %&gt;% tabyl(sex) %&gt;% adorn_totals() %&gt;% kable(digits = 2) %&gt;% kable_styling(bootstrap_options = c(&quot;striped&quot;, &quot;hover&quot;, &quot;condensed&quot;)) sex n percent M 736 0.38 F 1214 0.62 Total 1950 1.00 Para fazer uma tabela cruzada, em que seja possível apresentar a quantidade de homens e mulheres por país, épossível utilizar função pivot_wider: Dataset %&gt;% filter(!is.na(sex)) %&gt;% count(country,sex) %&gt;% pivot_wider(names_from = sex, values_from = n) %&gt;% kable(digits = 2) %&gt;% kable_styling(bootstrap_options = c(&quot;striped&quot;, &quot;hover&quot;, &quot;condensed&quot;)) country M F Espanha 384 825 Portugal 203 223 Brasil 149 166 Da mesma maneira como continuar com o tabyl, mas agora adicionando uma variável. Dataset %&gt;% filter(!is.na(sex)) %&gt;% tabyl(country, sex) %&gt;% adorn_totals() %&gt;% kable(digits = 2) %&gt;% kable_styling(bootstrap_options = c(&quot;striped&quot;, &quot;hover&quot;, &quot;condensed&quot;)) country M F Espanha 384 825 Portugal 203 223 Brasil 149 166 Total 736 1214 Finalmente, para apresentar a quantidade de participantes totais, bem como separar a quantidade e a porcentagem de homens e mulheres por país, a codificação torna-se mais densa. O código abaixo apresenta os comentários para auxiliar no entendimento da rotina. Dataset %&gt;% #get data #filter filter(!is.na(sex)) %&gt;% #agrupar group_by(country, add=TRUE) %&gt;% mutate(participantes = n()) %&gt;% #adicionar a relacao de quantidade de pais e sexo group_by(country, sex, participantes, add=TRUE) %&gt;% summarise( #cria a contagem de sexo sex_count = n(), #cria a porcentagem de sexo por pais sex_percentage = round(sex_count/first(participantes),2)) %&gt;% # cria uma variável agrupada mutate(n_percentage = paste0(sex_count,&quot; (&quot;,sex_percentage,&quot;)&quot;)) %&gt;% #seleciona apenas as variaveis de interesse select(country, sex, n_percentage, participantes) %&gt;% #Muda para formato largo de apresentação spread(sex, n_percentage, fill=&quot;-&quot;) %&gt;% #coloca os totais janitor::adorn_totals(&quot;row&quot;) %&gt;% kable(., digits = 2, booktabs = T) %&gt;% kable_styling(position = &quot;center&quot;, full_width = F, bootstrap_options = &quot;striped&quot;) country participantes M F Espanha 1209 384 (0.32) 825 (0.68) Portugal 426 203 (0.48) 223 (0.52) Brasil 315 149 (0.47) 166 (0.53) Total 1950 Ainda a partir da função tabyl, a realização desta tabela é simplificada. Dataset %&gt;% filter(!is.na(sex)) %&gt;% tabyl(country, sex) %&gt;% adorn_totals(c(&quot;row&quot;, &quot;col&quot;)) %&gt;% adorn_percentages(&quot;row&quot;) %&gt;% adorn_pct_formatting(rounding = &quot;half up&quot;, digits = 0) %&gt;% adorn_ns() %&gt;% adorn_title(&quot;combined&quot;) %&gt;% kable(., digits = 2, booktabs = T) %&gt;% kable_styling(position = &quot;center&quot;, full_width = F, bootstrap_options = &quot;striped&quot;) country/sex M F Total Espanha 32% (384) 68% (825) 100% (1209) Portugal 48% (203) 52% (223) 100% (426) Brasil 47% (149) 53% (166) 100% (315) Total 38% (736) 62% (1214) 100% (1950) 2.5 Gráficos A máquina gráfica do tidyverse é o ggplot. Pelo menos 3 argumentos são necessários para criação de gráficos, que são: O banco dados (data = ), que pode ser omitido da sintaxe, O aspecto estético, que permite diferentes complementos aes(x = , y = , fill = , color = ), O aspecto geométrico, que varia em função do gráfico a ser apresentado geom_ É também possível adicionar outros argumentos, como: 4. Transformações estatísticas stat_summary 5. Facetas para dividir a visualização facet_ 6. Sistema de coordenadas coord_ 7. Temas específicos theme_ É importante notar que apesar dos argumentos utilizados na sintaxe serem similares aos utilizados em toda família tidyverse, a ligação %&gt;% é substituída pelo +. Quando bem feitos, os gráficos são extremamente úteis. Como aponta Morettin e Bussab (Morettin and Bussab 2010), eles possibilitam: (a) buscar padrões e relações; (b) confirmar (ou não) certas expectativas que se tinha sobre os dados; (c) descobrir novos fenômenos; (d) confirmar (ou não) suposições feitas sobre os procedimentos estatísticos usados; e (e) apresentar resultados de modo mais rápido e fácil. É sempre bom que o gráfico tenha um título e uma escala. A maioria dos gráficos são apresentados em um plano com um eixo horizontal (abcissas) e um vertical (ordenadas). Por sua vez, tais planos se referem, nessa ordem, ou aos níveis da variável que está sendo medida (eixo x) e as contagens ou proporções encontradas (eixo y) ou aos níveis da variável independente (eixo x) e os resultados médios da variável dependente (eixo y). Para eleger que gráfico será realizado, é necessário responder a duas perguntas que são atreladas às pesquisas em Psicologia e áreas congêneres: 1. Quantas variáveis serão apresentadas ? 2. Qual o nível de medida da variával independente ? O diagrama abaixo oferece uma árvore de decisão funcional. 2.6 1 variável discreta Quando há apenas uma variável discreta (incluindo aqui as categóricas), os gráficos são criados para apresentar as contagens e/ou suas proporções. Nesse caso, é recomendado utilização de um gráfico de barras ou gráfico de setor. Apesar de ser possível apresentar as frequências absolutas, esses resultados podem gerar distorção da informação e, portanto, é preferível sempre apresentar as proporções de ocorrência de uma determinada variável ou valor. Por definição, quando se trabalha com proporções, o valor máximo da soma das proporções é 100. O gráfico de barras abaixo apresenta a contagem absoluta dos participantes pesquisados em cada país. ggplot(Dataset, aes(x = country)) + geom_bar(stats = identity) + labs(x = &quot;País&quot;, title = &quot;Número de participantes nos países investigados&quot;) ## Warning: Ignoring unknown parameters: stats Já abaixo, as barras são utilizadas considerando os resultados proporcionais. Para isso, um recurso do pacote scales foi utilizado para adequar o eixo y e também para adicionar o valor às colunas. ggplot(Dataset, aes(x = country, y = ..prop.., group = 1)) + geom_bar(stat = &quot;count&quot;) + geom_text(aes(label=scales::percent(round(..prop..,2)), y=..prop..), stat= &quot;count&quot;, color = &quot;white&quot;, size = 3, position = position_stack(vjust = 0.5)) + scale_y_continuous(labels = scales::percent_format()) + labs(x = &quot;País&quot;, title = &quot;Proporção de participantes em cada país investigado&quot;) O gráfico de setor (as vezes chamado de pizza ou torta) pode também ser utilizado. O aspecto principal desse gráfico é apresentar os setores de maneira proporcional às frequências. ggplot(Dataset, aes(x=factor(1), fill=country))+ geom_bar(width = 1) + coord_polar(&quot;y&quot;) + labs(title = &quot;Proporção de participantes em cada país&quot;) 2.7 1 variável contínua Quando uma única variável é apresentada no gráfico e ela é continua, os gráficos adequados são o histograma, densidade e o boxplot. Abaixo um histograma da idade dos participantes: ggplot(Dataset, aes(x = age)) + geom_histogram(bins = 30, color = &quot;black&quot;, fill = &quot;lightgrey&quot;) + labs(title = &quot;Distribuição da idade dos participantes&quot;) ## Warning: Removed 28 rows containing non-finite values (stat_bin). Abaixo um gráfico de densidade da idade: ggplot(Dataset, aes(x = age)) + geom_density(fill = &quot;lightgray&quot;) + labs(title = &quot;Distribuição da idade dos participantes&quot;) ## Warning: Removed 28 rows containing non-finite values (stat_density). Por sua vez, abaixo o boxplot dessa mesma variável: ggplot(Dataset, aes(y = age, x = &quot;&quot;)) + geom_boxplot() + labs(title = &quot;Distribuição da idade dos participantes&quot;) ## Warning: Removed 28 rows containing non-finite values (stat_boxplot). O boxplot tem vantagens em comparação com os outros gráficos apresentados até agora. A caixa reúne 50% da distribuição (Q1, Mediana e Q3) e os bigodes são construídos com base em Q1 - 1.5*IQR e Q3 + 1.5*IQR. Apesar de algo difícil de visualizar ao início, a informação apresentada no boxplot e no gráfico de densidade são iguais. gridExtra::grid.arrange( #Grafico 1 ggplot(Dataset, aes(x = age)) + geom_density(fill = &quot;lightgray&quot;), #Grafico 2 ggplot(Dataset, aes(y = age, x = &quot;&quot;)) + geom_boxplot() + coord_flip(), top = &quot;Distribuição da idade dos participantes&quot; #título ) ## Warning: Removed 28 rows containing non-finite values (stat_density). ## Warning: Removed 28 rows containing non-finite values (stat_boxplot). 2.8 2 variáveis com VI discreta (e VD contínua) Gráficos de barras ou colunas (considerando aqui as barras de erro) e o boxplot são adequados para apresentar essa relação. Basicamente, esses gráficos permitem verificar a diferença entre os grupos. Como exemplo, o gráfico abaixo mostra os resultados do Inventário Beck de Ansiedade entre 3 países investigados. As barras de erro são importantes para verificar, inicialmente, as possíveis diferenças significativas entre os países. ggplot(Dataset, aes(x = country, y = bai_sum)) + geom_bar(stat = &quot;summary&quot;) + stat_summary(geom = &quot;errorbar&quot;,fun.data = mean_se, width = .5) ## No summary function supplied, defaulting to `mean_se() O boxplot a seguir também é um gráfico indicado: ggplot(Dataset, aes(x = country, y = bai_sum)) + geom_boxplot() 2.9 2 variáveis com VI contínua (e VD contínua) Assumindo que a VI é contínua e a VD também, o gráfico de pontos e de dispersão são virtualmente identicos e indicados. Esses gráficos permitem verificar a associação entre as variáveis. No ggoplot, o argumento geom_point e geom_jitter são possíveis. Abaixo, utilizando os pontos. ggplot(Dataset, aes(x = age, y = bai_sum)) + geom_point() ## Warning: Removed 28 rows containing missing values (geom_point). Abaixo, utilizando o jitter ggplot(Dataset, aes(x = age, y = bai_sum)) + geom_jitter() ## Warning: Removed 28 rows containing missing values (geom_point). Tradicionalmente, de maneira análoga às barras de erros apresentadas em gráficos cujas VIs são discretas, adiciona-se uma reta de regressão amostral (fra) quando a VI é contínua, tal como apresentado a seguir. ggplot(Dataset, aes(x = age, y = bai_sum)) + geom_jitter() + geom_smooth(method = &quot;lm&quot;) ## Warning: Removed 28 rows containing non-finite values (stat_smooth). ## Warning: Removed 28 rows containing missing values (geom_point). 2.10 Outros gráficos e configurações Evidentemente, é possível apresentar mais informações nos gráficos com mais de um variável apresentada, desde que elas sejam relacionadas ao problema de pesquisa estudado e não sobrecarreguem a visualização dos resultados. Frequentemente, as informações adicionais são feitas pela inclusão de clusters ou agrupamentos. Isso é tanto possível em gráficos cuja VI seja discreta quanto contínua. No exemplo abaixo, o gráfico dos resultados do Inventário Beck de Ansiedade entre os 3 países investigados (VI discreta) agora está agrupado pelo sexo do participante. Dataset %&gt;% filter(!is.na(sex)) %&gt;% ggplot(., aes(x = country, y = bai_sum, fill = sex)) + geom_bar(stat = &quot;summary&quot;, position = &quot;dodge&quot;) + stat_summary(geom=&quot;errorbar&quot;, fun.data = mean_se, position = position_dodge(0.95), width = .5) ## No summary function supplied, defaulting to `mean_se() Já no exemplo abaixo, a relação entre idade e pontuação no Inventário Beck de Ansiedade está agora agrupada pelo sexo do participante. Dataset %&gt;% filter(!is.na(sex)) %&gt;% ggplot(., aes(x = age, y = bai_sum, color = sex)) + geom_jitter() + geom_smooth(method = &quot;lm&quot;) ## Warning: Removed 24 rows containing non-finite values (stat_smooth). ## Warning: Removed 24 rows containing missing values (geom_point). Em situações onde existe uma grande quantidade de informação para ser apresentada, os resultados começam a se tornar difíceis de serem entendidos. O gráfico abaixo, por exemplo, é excessivamente carregado de informação e, consequentemente, inadequado. Dataset %&gt;% filter(!is.na(sex)) %&gt;% ggplot(., aes(x = age, y = bai_sum, color = sex, shape = country)) + geom_jitter() + geom_smooth(method = &quot;lm&quot;) ## Warning: Removed 24 rows containing non-finite values (stat_smooth). ## Warning: Removed 24 rows containing missing values (geom_point). Em outro sentido, o gráfico a seguir quebra a apresentação dos resultados por país e, com isso, potencializa que a informação seja melhor compreendida. Dataset %&gt;% filter(!is.na(sex)) %&gt;% ggplot(., aes(x = age, y = bai_sum, color = sex)) + geom_jitter() + geom_smooth(method = &quot;lm&quot;) + facet_wrap( ~ country) ## Warning: Removed 24 rows containing non-finite values (stat_smooth). ## Warning: Removed 24 rows containing missing values (geom_point). 2.11 Resumo Este capítulo apresentou os aspectos tabulares e gráficos corriqueiramente encontrados em pesquisas de Psicologia e áreas congêneres. Entre os pontos principais, a heurística típica de construção de gráficos é um conteúdo importante para ser sempre lembrado. References "],
["teste-t.html", "Capítulo 3 Teste T 3.1 Pesquisa 3.2 Execução no R 3.3 Tamanho do efeito 3.4 Versão robusta do teste T 3.5 Mann-whitney 3.6 Teste T e regressão 3.7 Aspectos matemáticos", " Capítulo 3 Teste T Objetivos do capítulo 1. Apresentar o teste T 2. Discutir os pressupostos de execução do teste T 3. Realizar gráficos relacionados à comparação de médias 4. Apresentar e interpretar métricas de tamanho do efeito 5. Dar exemplos relacionados à escrita dos resultados 6. Apresentar versões não paramétricas O Teste T é um teste estatístico frequentemente utilizado para testar hipóteses sobre diferenças entre médias. Por utilizar dados amostrais para estimar um parâmetro (\\(\\mu\\)), ele é um teste parâmetrico. Apenas por um preâmbulo histórico, a origem do Teste T remonta o artigo publicado em 1908 por William Gosset. Na época, em função de seu trabalho na cervejaria Guiness, ele não assinou o artigo, mas apenas usou seu pseudônimo Student, motivo pelo qual o teste T também é chamado de Teste T de Student. É importante notar que estudantes de Psicologia e profissionais que trabalham com avaliação psicológica costumam ser deparados com uma métrica chamada “T score” (Escore T, as vezes), desenvolvido em 1939 por um professor de Psicologia (William Anderson McCall). Tenha em mente que essa métrica não ter relação com os procedimentos inferenciais relacionados ao teste T a não ser uma similaridade de nome (???; ???). É possível estipular que o Teste T pode ser utilizado para comparar a média de uma amostra com a média populacional (one sample t test), para comparar duas médias amostrais (two sample t test), ou para comparar duas médias de uma mesma amostra que foi investigada em dois momentos do tempo (paired ou matched t test). Se assume os seguintes pressupostos funcionais à execução de um Teste T: (i) Os dados são aleatórios e representativos da população (ii) a variável dependente é contínua (iii) A distribuição dos resultados populacionais é assumida como normal Quando há o interesse de utilizar o Teste T para comparar os resultados de dois grupos, é também necessário que: (iv) As variâncias dos grupos seja homogênea (princípio da homocedasticidade) (v) ambos os grupos sejam independentes Quando se utiliza o Teste T pareado, se viola o princípio da independência, mas é necessário que: (vi) o tamanho amostral seja o mesmo Eventualmente, quando os pressupos são violados, versões não-paramétricas podem ser implementadas. A tabela abaixo concatena os testes estatísticos relacionados e, para fins de comparação com outros trabalhos, há autores que sugerem que se use sempre as versões não-paramétricas em resultados obtidos por processos de avaliação psicológica, arguindo que os dados têm nível de medida “ordinal”. Versão do teste Um grupo Dois grupos independentes Grupos pareados Paramétrica One-sample t test Two-samples t test Paired t test Não-paramétrica Signed rank test Mann-whitney Wilcoxon 3.1 Pesquisa Base: Livro - R - ASQ SE all age intervals Neste capítulo, vamos utilizar a pesquisa intitulada “Confirmatory analysis and normative tables for the Brazilian Ages and Stages Questionnaires: Social–Emotional”, publicada em 2019 na Child Care Health Development. Esse trabalho teve dois objetivos. O primeiro visou confirmar a estrutura fatorial de um instrumento utilizado para avaliar competências sociais e emocionais relacionadas ao desenvolvimento infantil (ASQ:SE) e o segundo visou desenvolver tabelas normativas para comparar meninos e meninas. Essa é uma pesquisa muito importante, visto que conta com uma base de dados robusta (mais de 50 mil participantes) e costura psicometria, avaliação psicológica e políticas públicas 3.2 Execução no R Como exemplo, a variável dependente do teste T tem de ser contínua. Na base de dados específica às crianças de 12 meses (asq_12months), essa variável será computada pela soma de todos os itens da escala. No dplyr, isso é feito pela integração da função mutate com a select asq_12months &lt;- asq_12months %&gt;% mutate(total_12 = rowSums(select(., starts_with(&quot;q_&quot;)), na.rm = TRUE)) Uma vez que o interesse é o de comparar os resultados médios obtidos por meninos e meninas aos 12 meses, é necessário a escrita adequada das hipóteses e o nível de significância adotado na análise. Dessa maneira: \\[H_0 = \\mu_{meninos} - \\mu_{meninas} = 0 \\\\ H_a = \\mu_{meninos} - \\mu_{meninas} \\neq 0 \\\\ \\alpha = 0.05\\] Em seguida, o processo de testagem da hipótese é feito preliminarmente de maneira gráfica e, em seguida, pela implementação do teste específico. Apesar do gráfico não ser decisivo na tomada de decisão, ele auxilia a visualilzação da distribuição da variável que temos interesse, bem como oferece já um entendimento inicial dos resultados. Posto que a VI é discreta e a VD é continua (exposta no capítulo @ref(01-estatistica_descritiva)) tanto o gráfico de colunas/barras como o de densidade são úteis. O gráfico de barras tem uma vantagem de ser possível adicionar barras de erros, que serão melhores descritas futuramente. gridExtra::grid.arrange( #plot 1 ggplot(asq_12months, aes(x = sex, y = total_12, fill = sex)) + geom_bar(stat = &quot;summary&quot;) + stat_summary(fun.data = mean_se, geom = &quot;errorbar&quot;, width = .2), #plot 2 ggplot(asq_12months, aes(x = total_12, fill = sex)) + geom_density(color = NA, alpha=.6) ) ## No summary function supplied, defaulting to `mean_se() Feito isso, o próximo passo é a testagem formal da hipótese. Como exposto, o teste T de duas amostras independentes assume que os resultados da variável de interesse se distribua normalmente e que variância entre os grupos seja homocedástica. Tecnicamente, como o teste T é um caso especial de um modelo de regressão, a normalidade da variável de interesse se refere aos resíduos do modelo e, neste caso pode ser testada pela distribuição marginal dos resultados de ambos os grupos. A normalidade pode ser avaliada graficamente por QQ-plots e por testes específicos, como o Shapiro-wilk, Anderson-Darling e Jarque Bera. O QQ plot é um gráfico que reúne a distribuição empírica ordenada dos quantis conta os quantis da distribuição teórica (aqui, normal). Se os dados e a linha diagonal se soprepuserem, isso é uma evidencia de que a distribuição empírica é a mesma da distribuição teórica. Caso haja discrepância, isso aponta para desvio da normalidade. ggplot(asq_12months, aes(sample = total_12)) + stat_qq() + stat_qq_line() + facet_wrap(~sex) Apesar do gráfico já ter sido bastante claro e sugerir fortemente desvio da normalidade em ambos os grupos, o teste formal é necessário. O Shapiro-wilk costuma ser utilizado neste caso, uma vez que ele reúne diferentes características positivas no balanço entre erro do tipo 1 e 2. a Hipótese nula desse teste assume que a variável de interesse tem distribuiÇào (aproximadamente) normal. Assim, rejeitar a hipótese nula sugere que esse princípio foi violado e, com isso, o teste T pode ter resultados distorcidos. asq_12months %&gt;% group_by(sex) %&gt;% summarise(shapiro = shapiro.test(total_12)$p.value) ## # A tibble: 2 x 2 ## sex shapiro ## &lt;fct&gt; &lt;dbl&gt; ## 1 M 1.98e-19 ## 2 F 4.80e-17 De maneira convergente ao gráfico, o Shapiro-wilk também apontou que o princípio da normalidade foi violado. Entretanto, por finalidades didáticas, as análises continuarão. A homogeneidade das variâncias pode ser testada pelo teste de Bartlett e Levene. De maneira análoga ao Shapiro-wilk, esses testes assumem como Hipótese nula a homogeneidade das variâncias. Consequemente, a rejeição desse pressuposto pode também trazer resultados distorcidos ao resultado do teste T. Abaixo, o teste de Bartlett. bartlett.test(total_12 ~ sex, data = asq_12months) ## ## Bartlett test of homogeneity of variances ## ## data: total_12 by sex ## Bartlett&#39;s K-squared = 1.1357, df = 1, p-value = 0.2866 Diferentemente do pressuposto da normalidade, o pressuposto da homocedasticidade foi preservado. Agora, finalmente, o teste t. (t_test_12m &lt;- t.test(total_12 ~ sex, var.equal = T, data = asq_12months)) ## ## Two Sample t-test ## ## data: total_12 by sex ## t = 0.36787, df = 1039, p-value = 0.713 ## alternative hypothesis: true difference in means is not equal to 0 ## 95 percent confidence interval: ## -2.077671 3.036424 ## sample estimates: ## mean in group M mean in group F ## 24.91713 24.43775 Os resultados trazem a média de ambos os grupos (24.9171271 e 24.437751), a estatística do teste (0.3678679, as vezes chamada de T calculado), os graus de liberdade (1039) e o valor de p 0.7130467. Repare que como o valor de p é superior ao valor estipulado do nível de significância (0.05), falha-se eem rejeitar a Hipótese nula, indicando que, apesar de numericamente distintos, os resultados não são estatisticamente significativos. A apresentação abaixo traz o output do teste T. Como escrever os resultados Os dados foram analisados por um Teste T de amostras independentes para investigar as diferenças médias nos resultados do desenvolvimento entre meninos e meninas. Os resultados mostraram que os valores médios de meninos e meninas não não são significativamente diferentes (t(1039) = 0.37, p = 0.71). Dessa maneira, as diferenças encontradas podem ser mais bem explicadas por outras fontes de variações. Com isto concluído, é também possível verificar se existem diferenças em idades mais avançadas. A sintaxe é customizável e torna-se fácil testar a hipótese da diferença, por exemplo, aos 18 meses. Nesse sentido, o teste de hipóteses deve ser normalmente escrito: \\[H_0 = \\mu_{meninos} - \\mu_{meninas} = 0 \\\\ H_a = \\mu_{meninos} - \\mu_{meninas} \\neq 0 \\\\ \\alpha = 0.05\\] O gráfico novamente deve ser realizado gridExtra::grid.arrange( ggplot(asq_18months, aes(x = sex, y = score, fill = sex)) + geom_bar(stat = &quot;summary&quot;) + stat_summary(fun.data = mean_se, geom = &quot;errorbar&quot;, width = .2), ggplot(asq_18months, aes(x = score, fill = sex)) + geom_density(color = NA, alpha=.6)) ## No summary function supplied, defaulting to `mean_se() Bem como a verificação do pressuposto de normalidade e homocedasticidade, seguidos pelo teste formal. (t_test_18m &lt;- t.test(score ~ sex, var.equal = T,data = asq_18months)) ## ## Two Sample t-test ## ## data: score by sex ## t = 4.6185, df = 5725, p-value = 3.949e-06 ## alternative hypothesis: true difference in means is not equal to 0 ## 95 percent confidence interval: ## 1.484680 3.674581 ## sample estimates: ## mean in group M mean in group F ## 27.52685 24.94722 Diferentemente do anterior, agora o resultado foi significativo (p &lt; 0.01) e deve ser reportado: Como escrever os resultados Os dados foram analisados por um Teste T de amostras independentes para investigar as diferenças médias nos resultados do desenvolvimento entre meninos e meninas com 18 meses idade. Os resultados mostraram que os valores médios de meninos (M = 27.5, SD = 21.8) e meninas (M = 24.9, SD = 20.3) são significativamente diferentes (t(5725) = 4.62, p &lt; 0.01). É importante ter uma atenção especial à significância estatística. De forma alguma, um resultado que rejeita a hipótese nula (como o de agora) deve ser entendido como “aceitação da hipótese alternativa”, tampouco como evidência de causalidade. É fundamental lembrar que o valor de P se refere à probabilidade de encontrar a estatística de teste calculada, ou uma ainda mais exterma, assumindo que a hipótese nula é verdadeira. Apesar de algo contra-intuitivo (e talvez desanimador), é assim que a estatística frequentista funciona. 3.3 Tamanho do efeito Resultados significativos não são nenhum pouco claros em relação ao tamanho do efeito. Essa métrica tem mais contato com as perguntas originalmente realizadas em uma pesquisa e é entendida como uma medida objetiva e padronizada da magnitude de um efeito observado independente da significância estatística. Existem duas famílias principais no framework do tamanho do efeito, que são a família d e a família r. Tecnicamente, quando comparamos médias, usamos o d de cohen para calcular a distância entre as médias das distribuições normais sobrepostas. A interpretação é a seguinte: Cohen’s d Interpretação d \\(\\geq\\) 0.8 Alto d \\(\\geq\\) 0.5 Medio d \\(\\geq\\) 0.2 Pequeno d &lt; 0.2 Irrelevante library(effsize) cohen.d(score ~ sex, data = asq_18months) ## ## Cohen&#39;s d ## ## d estimate: 0.12216 (negligible) ## 95 percent confidence interval: ## lower upper ## 0.07025972 0.17406037 Agora é possível agregar ambos os resultados e a escrita iria por esse caminho. Como escrever os resultados Os dados foram analisados por um Teste T de amostras independentes para investigar as diferenças médias nos resultados do desenvolvimento entre meninos e meninas com 2 anos de idade. Os resultados mostraram que os valores médios de meninos (M = 27.5, SD = 21.8) e meninas (M = 24.9, SD = 20.3) são significativamente diferentes (t(5725) = 4.62, p &lt; 0.01), apesar do tamanho do efeito ser negligenciável (d = 0.12). 3.4 Versão robusta do teste T Em muitas situações, os pressupostos do teste T são violados e parte da literatura argumenta que o teste T é robusto o suficiente para lidar com isso (Lumley et al. 2002), equanto outra parte sugere que é melhor optar por versões com médias aparadas ou não-paramétricas (Field and Wilcox 2017). No entanto, o que não costuma ser discutido com tanta frequência é que a modificação do teste estatístico utilizado, necessariamente, modifica a hipótese da pesquisa. Nesse sentido, a decisão de alterar o teste estatístico deve ser feito com justificativa teórica por parte do pesquisador. O pacote WRS apresenta versões robusta do Teste T. Ainda, o próprio R base oferece uma solução para condições em que a homogeneidade dos grupos não é aceita, que é o Welch-test. Esse teste é feito assumindo estipulando var.equal = F na sintaxe previamente exposta ou removendo este argumento por completo. 3.5 Mann-whitney A chamada versão paramétrica do teste T é o teste de Wilcoxon-Mann-Whitney. Quando os pressupostos do teste T são violados, o Mann-Whitney é um candidato para substituição. Se de um lado esse teste supera tais pressupostos, por outro ele responde a uma hipótese diferente daquela que o teste T trabalha. Enquanto o teste T compara médias, o Mann-whitney compara os valores ranqueados (postos). Nota-se que ele não é um teste para comparar medianas e que isso só ocorre em condições restritas. (mann_whiyney_18m &lt;- wilcox.test(score ~ sex, data = asq_18months)) ## ## Wilcoxon rank sum test with continuity correction ## ## data: score by sex ## W = 4368187, p-value = 9.902e-06 ## alternative hypothesis: true location shift is not equal to 0 Os resultados foram convergentes ao previamente encontrado e, em outras palavras, tambem apoiam a rejeição da hipótese nula. O tamanho do efeito também pode ser calculado ao implementar \\(Z/sqrt(n)\\). O output padrão do R não oferece essa informação, mas o pacote coin dispõe dessa métrica. coin::statistic(coin::wilcox_test(score ~ sex, data = asq_18months)) ## [1] 4.41932 Assim, implementando a fórmula, o tamanho do efeito seria aproximadamete 0.06. Como escrever os resultados Os dados foram analisados pelo teste Wilcoxon-Mann-Whitney para investigar as diferenças nos resultados do desenvolvimento entre meninos (Mdn = 25, IQR = 30, M = 27.53, SD = 21.61) e meninas (Mdn = 20, IQR = 25, M = 24.95, SD = 20.34) com 18 meses de idade. Os resultados indicaram que os resultados foram significativos (W = 4368187, p &lt; 0.01), mas com efeito negligenciável (0.12). 3.6 Teste T e regressão Conforme alertado, o Teste T é um caso particular deum modelo de regressão que assume que a variável independente é uma dummy. Assim, \\(b_0\\) (intercepto) é o grupo que recebeu o valor 0 e \\(b_1\\) (inclinação) é o grupo que recebeu o valor 1. Caso isso não tenha sido definido inicialmente, basta estipular que a variável é um fator e o R cuidará de todo o resto. Nesse caso, o R atribuiu os meninos como intercepto o valor médio dos meninos e a inclinação \\(b_1\\) é justamente a diferença entre os valores (24.95-27.53). Nesse caso, -2.58. A estatística F é equivalente a \\(t^2\\) do teste t em sua versão tradicional (assumindo variâncias iguais entre grupos, adicionando var.equal = T à função). lm(score ~ sex, data = asq_18months) %&gt;% stargazer::stargazer(., type = &quot;text&quot;) ## ## =============================================== ## Dependent variable: ## --------------------------- ## score ## ----------------------------------------------- ## sexF -2.580*** ## (0.559) ## ## Constant 27.527*** ## (0.387) ## ## ----------------------------------------------- ## Observations 5,727 ## R2 0.004 ## Adjusted R2 0.004 ## Residual Std. Error 21.117 (df = 5725) ## F Statistic 21.331*** (df = 1; 5725) ## =============================================== ## Note: *p&lt;0.1; **p&lt;0.05; ***p&lt;0.01 3.7 Aspectos matemáticos [Em desenvolvimento] "]
]
