---
output: html_document
editor_options: 
  chunk_output_type: inline
---
# Estatística Descritiva

```{r base pesquisa_espanha e pacotes, include = FALSE }

load("~/anovabr/mqt/bases/Base R - Pesquisa mapfre.RData") #base

library(tidyverse)
library(pander)
library(knitr) #tables and graphs
library(kableExtra) #tables with different styles

library(DiagrammeR) #flowcharts
library(gridExtra) #plot together
library(janitor) #descritipve stats

```


```{block, type="objectives"}
**Objetivos do capítulo**  
1. Introduzir conceitos importantes em estatística descritiva  
2. Apresentar tabelas e gráficos  
3. Apresentar funções do dplyr e ggplot    
4. Apresentar um módulo específico do JASP   
5. Sugerir heurísticas ou regras gerais na criação de gráficos  
```

Quando pesquisadores e acadêmicos fazem seus estudos, com muita frequência, eles obtêm um grande conjunto de dados, sendo pouco informativo ou até mesmo inviável apresentar detalhadamente todos os resultados. A estatística descritiva oferece uma diversidade de ferramentas que auxiliam a <mark>descrever, resumir e apresentar</mark> os dados obtidos, de forma que os resultados sejam mais fáceis de serem compreendidos e analisados.   

Frequentemente, a massa completa de dados obtidos em uma pesquisa é resumida por alguns números específicos, que possuem certas propriedades estatísticas, e conseguem resumir adequadamente o volume de dados. Por sua vez, esses números são usados em análises específicas que possam ser necessárias. 

Na apresentação dos dados, é possível utilizar <u>informações textuais</u>, <u>tabelas</u> e <u>gráficos</u>. Cada uma dessa formas traz vantagens e desvantagens. Tabelas e textos permitem agrupar e detalhar os resultados e, com isso, torná-los mais precisos e extensivos. Entretanto, esse detalhamento pode também dificultar um pouco no entendimento geral e abrangente do estudo. Por sua vez, gráficos geram sumários descritivos, em que é possível ter um entendimento rápido dos principais resultados. Gráficos também podem incorporar outros elementos que auxiliam em uma primeira análise inferencial, tal como barras de erro e intervalos de confiança e além disso, dependendo do tipo de pesquisa, os gráficos podem descrever tanto <u>diferenças</u> entre grupos, como <u>relações</u> entre variáveis. No entanto, uma vez que os gráficos oferecem uma condensação de um grande conjunto de resultados, eles também podem dificultar um pouco no entendimento das conclusões.  

O diagrama a seguir apresenta tais características:

![](./img/cap_desc_graficos_tabelas.png)

É importante atentar que em todas estas técnicas, mas especialmente nas gráficas, deve-se evitar gerar distorções ao entendimento e interpretação dos resultados obtidos no estudo. Existem recomendações nacionais e internacionais que visam auxiliar no  desenvolvimento de gráficos e tabelas e, com grande frequência, periódicos e editoras também requerem que formatos específicos na apresentação dos resultados sejam seguidos.
 


## Medidas de posição e dispersão  

Uma vez que é pragamaticamente inviável apresentar detalhadamente todo o volume de dados obtidos em uma pesquisa, há um conjunto de números podem ser utilizados para <u>resumir</u> todo o conjunto. Eles costumam ser chamadados de números-síntese, medidas estatísticas ou apenas estatísticas e podem ser agrupados em <u>medidas de posição</u> e <u>medidas de dispersão</u>, que serão descritas a seguir.

<mark>Medidas de posição</mark>: valores que representam a concentração dos dados observados. Podem ser divididas em medidas de tendência central, medidas separatrizes ou de ordenamentos e medidas de posição relativa. As medidas de tendência central (MTC) indicam o valor em torno do qual uma grande proporção de outros valores está centralizada. As MTC mais usadas são a moda, a média e a mediana. As separatrizes são valores que indicam posições em uma distribuição ordenada acumulada dos dados. Frequentemente, a mediana e os quantis são utilizados e este último é formado pelos quartis (divisão dos dados em 4 partes iguais), decis (divisão em 10 partes iguais) e percentis (divisão em 100 partes iguais). As medidas de posição relativa são valores que indicam as posições que cada valor do conjunto de dados em relação a todos os dados. Frequentemente, o Escore Z, o Escore T e o Escore QI são utilizados como medidas de posição de relativa. A verdade é que essa divisão tão detalhada sempre apresenta inconsistências e quase nunca é utilizada na prática. No dia a dia, o termo MTC é utilizado de maneira virtualmente idêntica a medidas de posição.  

<Mark>Medidas de dispersão </mark>. Também chamadas de medidas de variabilidade ou afastamento. São Valores que indicam o quão dispersa se encontra a distribuição dos valores em relação à alguma medida de tendência central. Entre as medidas de dispersão, estão a amplitude, a amplitude (ou intervalo) interquartil, a variância, o desvio-padrão e o coeficiente de variação. Em Psicologia, o desvio-padrão e a amplitude interquartil (também chamado de intervalo interquartil) são as mais utilizada.  
O diagrama abaixo apresenta estas informações.


![](./img/cap_desc_medidas_posicao_dispersao.png)



É importante notar que esse conjunto de divisões tem pouco sentido prático na maioria das pesquisas e do cotidiano dos pesquisadores. Apenas em raras exceções, como em Psicometria, é que discussões sobre percentis e Escores Z serão feitas. Dessa maneira, apesar dessa apresentação representar um esforço para reunir as principais medidas estatísticas utilizadas, ela não traduz bem a realidade cotidiana da maior parte das pesquisas e, consequetemente, dos pesquisadores. 


Com muita frequeência, as medidas de posição e as medidas de tendência central são vistas como sinônimos, bem como utiliza-se apenas o termo "medidas de dispersão" para todas as medidas de afastamento. Dessa forma, a organização apresentada no diagrama abaixo talvez possa ser mais útil.




![](./img/cap_desc_medidas_posicao_dispersao2.png)

As principais medidas serão agora apresentadas de uma maneira simples. Esse formato é proposital, uma vez que a proposta do livro é discutir tais conceitos pela apresentação de pesquisas específicas e previamente publicadas.  


## Média

A média é a MTC mais comum e mais intuitiva. Seu valor representa o “centro de gravidade” da distribuição, descrevendo a maior concentração dos valores em torno dela. Assim, ela resume o conjunto de dados e pode ser utilizada para substituir os outros valores, o que é especialmente útil quando há casos ausentes.  

Imagine a seguinte situacão. 10 pacientes foram avaliados por um teste de inteligência e apresentaram os resultados abaixo descritos:  

```{r}
set.seed(1)
rnorm(11, mean = 100, sd = 15) %>% pander()
```

A média indicará o valor central da distribuição em relação à distância entre os outros valores.

```{r}
set.seed(1)
mean(rnorm(11, mean = 100, sd = 15)) %>% pander()
```
   
Repare que Caso uma tabela seja apresentada e nela seja calculado a distância de todos os valores em relação à média, os resultados seriam assim:

```{r}
set.seed(1)
rnorm(11, mean = 100, sd = 15) %>% data.frame() %>% setNames(., c("Resultado")) %>% 
mutate(media = mean(Resultado)) %>% 
mutate(distancia = Resultado-media) %>% 
pander()
```
Somando as distâncias, o resultado será `0`, indicando que elas se anulam e que a média é o centro da distribuição.

```{r}
set.seed(1)
rnorm(11, mean = 100, sd = 15) %>% 
  data.frame() %>% setNames(., c("Resultado")) %>% 
  mutate(media = mean(Resultado)) %>% 
  mutate(distancia = Resultado-media) %>%
  mutate_if(is.numeric, round, 1) %>% 
  mutate(media = as.character(media)) %>% 
  janitor::adorn_totals() %>% 
  pander()
```

A tabela a seguir descreve algumas características vantajosas e possíveis limitações da média.


  | Vantagem                           | Limitação                          |  
  | :-----------                       | :-----------                       | 
  | É intuitiva                        | Sensível                           | 
  | Algebricamente tratável            | Não adequada a dados nominais      | 
  | Estimador não viesado              |                                    | 
  | Sensível                           |                                    | 

Nota: Uma medida sensível significa que ela é influenciada por todos os outros valores.  

<mark>Exemplo de aplicações</mark>:  Praticamente, em todas as pesqusias se utiliza a média para sumarizar os resultados obtidos. Como exemplos em Psicologia, a média de valores de inventários e testes psicológicos, a média do tempo de reação que um participante demora para responder à uma atividade específica e a média de consultas clínicas que em média um profissional realiza.    


## Mediana

A mediana é uma medida que representa o centro do conjunto de dados quando se considera a quantidade de elementos presentes. Uma vez que ela divide a distribuição em duas partes iguais com a mesma quantidade de elementos, ela pode tanto ser vista como uma medida de tendência central, como uma separatriz (5º decil e percentil 50). Comparada com a média, os resultados obtido pela mediana são mais robustos ou resistentes aos valores atípicos ou anômalos, apesar de menos intuitivos.  

Para dividir a distribuição em duas partes iguais, a realização da mediana precisa de alguns procedimentos. Repare que abaixo estão os mesmo resultados apresentados na seção da média:


```{r}
set.seed(1)
rnorm(11, mean = 100, sd = 15) %>% pander()
```

Para o cálculo da mediana, é necessário organizar essa série de valores de maneira ascendente (chamado de rol) e localizar o resultado ao centro. Nesse caso, o valor ao centro é `104.9` . Note que este valor divide os dados em duas partes iguais de elementos abaixo ou acima dele.


```{r}
set.seed(1)
rnorm(11, mean = 100, sd = 15) %>% sort(.) %>% pander()
```

Caso a quantidade de elementos seja par, a mediana será a média artimética dos dois elementos centrais.

A tabela a seguir descreve algumas características vantajosas e possíveis limitações da mediana.


  | Vantagem                                                   | Limitação                          |  
  | :-----------                                               | :-----------                       | 
  | Resistente a valor anômalos/Outliers                       | Não representa todos os valores    | 
  | Adequada para dados ordinais, intervalares e de razão      | Não adequada a dados nominais      | 
  | Adequada para dados ordinais, intervalares e de razão      | Pouco adequada a tratamentos algébricos futuros     | 


<mark>Exemplo de aplicações</mark>:  Situações em que a distribuição é muito assimétrica. Variáveis econômicas como salário e pobreza costumam trabalhar com a mediana dos dados.    

## Moda  

A moda é a realização mais frequente de um conjunto de dados. Salvo algumas excessões, a moda não costuma ser utilizada em análises estatísticas, uma vez que representa mal o conjunto de dados.  

<mark>Exemplo de aplicações</mark>:  Situações em saúde pública, como a idade mais típica que uma menina tem o primeiro filho, dia e/ou horário modal de Admissão em um hospital. Situações economômicas de determinação de salários mínimos, eventualmente, também pode contar com resultados modais.  


## Amplitude

A amplitude é uma medida de dispersão que indica a variabilidade dos dados. O procedimento para seu cálculo é a subtração entre o maior e o menor valor de um conjunto de dados.  

## Amplitude interquartil

A amplitude interquartil também é chamada de intervalo interquartil. Essa medida apresenta a variabilidade dos dados de maneira insensível a valores extremos. Ela é computada pela subtração do primeiro quartil (Q1) pelo terceiro quartil (Q3), ou seja, `Q3-Q1`. Os quartis são medidas que indicam posições de separação no conjunto ordenado de dados.  

O primeiro quartil indica o valor onde estão até 25% dos dados, o segundo quartil tem o mesmo valor da mediana e o terceiro quartil indica o valor onde estão até 75% dos dados. 

Como a amplitude interquartil considera apenas a variabilidade em torno do centro, ela é uma medida considerada mais estável ou robusta quando comparada a outras.

## Variância e Desvio-padrão

A variância e o desvio-padrão são duas medidas de dispersão frequentemente utilizadas em estatística, mas que apresentam algumas características diferentes. 

A variância é uma medida que indica a variabilidade (quadrática) de um conjunto de dados, considerando todos os valores da distribuição. Pela sua estrutura matemática, seu resultado expressa o desvio <u>quadrático</u> médio e, com isso, seu valor <u>não</u> está na mesma unidade dos dados originais.  

A variância é uma medida fundamental no estudo das famílias de distribuições de probabilidades e análises estatísticas. No entanto, na prática, ela é pouco usada para descrever a variabilidade dos dados e acaba sendo usada apenas de forma transitória para o cálculo do desvio-padrão. 


O desvio-padrão, por sua vez, é uma medida com melhores características descritivas. Ele indica a variação dos valores em torno da média, e como seus resultados são calculados pela raiz quadrada da variância, o desvio-padrão está na mesma unidade dos dados originais. . 

Em síntese, enquanto a variância tem maior importância em aspectos matemáticos relacionados às famílias de distribuições de probabilidade, o desvio-padrão tem melhor adequação descritiva de um conjunto de dados.  Conceitualmente, as equações a seguir descrevem à variância amostral (à esquerda) e o desvio-padrão amostral (à direita):

\begin{equation}
  \begin{split}
    S^2 = \sqrt\frac{\sum\limits_{i=1}^N (X -\mu)^2}{N-1}
  \end{split}
\qquad\qquad\qquad
  \begin{split}
    S = \frac{\sum\limits_{i=1}^N (X -\mu)^2}{N-1}
  \end{split}
\end{equation}


Após estas apresentações teóricas, espera-se que seja possível apresentar a pesquisa a seguir, bem como implementar parte dos conceitos nos dados obtidos.  

## Pesquisa
  
<div class="alert alert-info" role="alert">
  <strong>Base:</strong> Base R - Pesquisa mapfre.RData
</div>  

Neste capítulo, vamos utilizar a pesquisa intitulada ["Depression and Anxiety Symptoms in a Representative Sample of Undergraduate Students in Spain, Portugal, and Brazil"](https://doi.org/10.1590/0102.3772e36412 ). Nessa pesquisa, sou o coautor e o pesquisador responsável para correspondência. O objetivo deste estudo foi desenvolver um mapa epidemiológico de sintomas de ansiedade e depressão em universitários em três países, bem como investigar possíveis relações entre tais condições de saúde e fatores sociodemográficos. Para acessar eventuais transtornos depressivos, o Inventário Beck de Depressão (BDI) foi utilizado e para acessar condições de ansiedade, o Inventário Beck de Ansiedade (BAI) foi utilizado.  

Um diferencial importante do trabalho foi a seleção amostral. Partiu-se de uma amostra estratificada (probabilística) dos estudantes de três universidades, PUC-Rio (Brasil), Universidade de Extremadura (Espanha) e Universidade de Coimbra (Portugal). Isso permitiu ter maior validade externa dos resultados.


## Execução no R 

Inicialmente, é necessário carregar a base de dados previamente descrita para o ambiente R. Este procedimento será necessário para todos os capítulos do livro.  

## Tabelas   

Tabelas apresentam os sumários informativos de uma pesquisa de maneira reunida e objetiva. É possível utilizá-las com apenas uma ou com múltiplas variáveis, sejam elas categóricas ou contínuas. As tabelas precisam ter um título, bem como colunas e linhas. Com frequência, as instrução para desenvolvimento de tabelas variam de editora para editora e, segundo a APA, apenas as linhas superiores e inferiores recebem bordas e números decimais são arredondados até a segunda casa decimal.  

Frequentemente, Uma primeira tabela informativa deve apresentar a quantidade de participantes amostrados. Neses caso, como três países fizeram parte da pesquisa, os dados serão agrupados por eles. O desenvolvimento desta tabela pode ser feito com pacote `janitor`, tal como demonstrado a seguir.

```{r}
Dataset %>% 
  tabyl(country) %>% 
  adorn_totals() %>% 
  pander()

```

A adição de um um outro agrupador relacionado ao sexo é também importante. Note que existem casos ausentes nesta variável. Isso ocorre com bastante frequência e há diferentes estratégias para lidar com isso, que serão discutidas em momento oportuno. Para que valores ausentes não sejam apresentados, a função `filter` será implementada.   

```{r}
Dataset %>% 
  filter(!is.na(sex)) %>% 
  tabyl(sex, country) %>% 
  adorn_totals() %>% 
  pander()
```

Para apresentar a quantidade de participantes totais, bem como a quantidade e a porcentagem de homens e mulheres por país, a codificação torna-se um pouco mais densa. A tabela a seguir reproduz parcialmente a tabela 1 do artigo publicado.  

```{r}
Dataset %>%
  filter(!is.na(sex)) %>% 
  tabyl(country, sex) %>%
  adorn_totals(c("row", "col")) %>%
  adorn_percentages("row") %>% 
  adorn_pct_formatting(rounding = "half up", digits = 0) %>%
  adorn_ns() %>%
  pander()
```
Enquanto as tabelas com variáveis categóricas apresentam valores absolutos e suas respectivas porcentagens, tabelas para variáveis contínuas costumam utilizar medidas de posição e dispersão. A média e a mediana são os sumários mais utilizados para indicar a posição ou a concentração dos dados. Por sua vez, o desvio-padrão e a amplitude ou intervalo interquartil são utilizados para indicar o afastamento dos dados dessas medidas de posição. O R oferece muitos pacotes especializados em tabelas descritivas, cada qual com características positivas e limitadoras. 


De maneira análoga à construção da primeira tabela deste capítuo, os valores do BDI e do BAI serão apresentados em função do país do participante.

```{r}
Dataset %>%
  group_by(country) %>% 
  summarise_at(vars(bdi_sum, bai_sum), lst(n=~n(),media=mean, DP=sd), na.rm=T) %>% 
  mutate_if(is.numeric, round,2) %>% 
  t() %>% 
  pander(., split.table = Inf)
```

É também possível reunir tais resultados a partir do sexo do participante.


```{r}
Dataset %>%
  filter(!is.na(sex)) %>% 
  group_by(sex) %>% 
  summarise_at(vars(bdi_sum, bai_sum), lst(n=~n(),media=mean, DP=sd), na.rm=T) %>% 
  mutate_if(is.numeric, round,2) %>% 
  t() %>% 
  pander(., split.table = Inf)
```
A apresentação agrupando pelo país e sexo do participante encontra-se abaixo:  

```{r}
Dataset %>%
  filter(!is.na(sex)) %>% 
  group_by(country,sex) %>% 
  summarise_at(vars(bdi_sum, bai_sum), lst(n=~n(),media=mean, DP=sd), na.rm=T) %>% 
  mutate_if(is.numeric, round,2) %>% 
  t() %>% 
  pander(., split.table = Inf)
```


## Gráficos

A máquina gráfica do tidyverse é o ggplot. Para executar um gráfico, <mark>pelo menos</mark> 3 argumentos são necessários para criação de gráficos, que são:

1. O banco dados `(data = )`,      
2. O aspecto estético, que permite diferentes complementos `aes(x = , y = , fill = , color = )`,  
3. O aspecto geométrico, que varia em função do gráfico a ser apresentado `geom_ ` 

É também possível adicionar outros argumentos, como:  

4. Transformações estatísticas `stat_summary`  
5. Facetas para dividir a visualização `facet_`  
6. Sistema de coordenadas `coord_`  
7. Temas específicos `theme_ `  

É importante notar que apesar dos argumentos utilizados na sintaxe serem similares aos utilizados em toda família tidyverse, a ligação `%>%` é substituída pelo `+`. 

Quando bem feitos, os gráficos são extremamente úteis. Como aponta Morettin e Bussab [-@morettin_bussab_2010], eles possibilitam:   

(a) buscar padrões e relações;     
(b) confirmar (ou não) certas expectativas que se tinha sobre os dados;   
(c) descobrir novos fenômenos;  
(d) confirmar (ou não) suposições feitas sobre os procedimentos estatísticos usados; e  
(e) apresentar resultados de modo mais rápido e fácil.  

É sempre bom que o gráfico tenha um título e uma escala. A maioria dos gráficos são apresentados em um plano com um eixo horizontal (abcissas) e um vertical (ordenadas). Quando há apenas uma variável para apresentar, o eixo x irá reunir seus níveis e o eixo y as contagens ou proporções e densidade. Quando há duas variáveis, o eixo x irá apresentar os níveis da variável indepenente, enquanto o y apresentará os valores médios encontrados. Quando há mais de uma variável independente, um agrupador ou cluster deverá ser computado. Com frequência, o eixo x recebe a variável independente com mais níveis, enquanto o agrupador recebe as outras.   

Existem diferentes heurísticas que auxiliam na escolha do melhor gráfico a ser desenvolvido para apresentar os resultados de uma pesquisa. Uma delas parte do pressuposto que, quando há duas ou mais variáveis, a VD é continua e solicita que duas perguntas sejam respondidas, que são:  

1. <mark>Quantas</mark> variáveis serão apresentadas ?  
2. Qual o <mark>nível de medida da variával independente </mark>?  

Com isso, o diagrama abaixo oferece uma árvore de decisão funcional.

```{r, echo=FALSE}
grViz("digraph flowchart {
      # node definitions with substituted label text
      
      node [
      fontname = Helvetica,
      fillcolor = 'Orange', 
      shape = rectangle,
      style = filled]
      
      A[label = 'Quantas variáveis vão ser apresentadas?']
      B[label = 'Nivel de medida da VI']
      C[label = 'Nivel de medida da VI']
      

      node [fillcolor = 'white', style = filled]
      A -> 'Apenas 1';
      A -> '2 ou +';

      'Apenas 1' -> B -> { 'Discreta' 'Contínua' };
      '2 ou +' -> C -> { 'Discreta ' 'Contínua '};
       
       Discreta -> { Setor Barras }
       Contínua -> { Histograma Densidade Boxplot }
       
       
       'Discreta ' -> { 'Barras ' Colunas 'Boxplot ' }
       'Contínua ' -> { Linhas Dispersão }
       
       
     }")
```

Nota: Nessa apresentação, pragmaticamente as variáveis categóricas são tratadas como discretas.


## 1 variável discreta

Quando há apenas uma variável discreta (incluindo aqui as categóricas), os gráficos são criados para apresentar as contagens e/ou suas proporções. Nesse caso, é recomendado utilização de um <u>gráfico de barras</u> ou <u>gráfico de setor</u>. Apesar de ser possível apresentar as frequências absolutas, esses resultados podem gerar distorção da informação e, portanto, é preferível sempre apresentar as proporções de ocorrência de uma determinada variável ou valor. Por definição, quando se trabalha com proporções, o valor máximo da soma das proporções é 100.

O gráfico de barras abaixo apresenta a contagem absoluta dos participantes pesquisados em cada país.

```{r}
ggplot(Dataset, aes(x = country)) +
  geom_bar() +
  labs(x = "País", title = "Número de participantes nos países investigados")
```

Apesar desse gráfico auxiliar em um primeiro entendimento dos dados, a mudança da contagem para proporções é indicada. Para fazer isso, um recurso do pacote `scales` pode ser usado para adequar o eixo y e adicionar o valor textual às colunas.

```{r}
ggplot(Dataset, aes(x = country, y = ..prop.., group = 1)) + 
  geom_bar(stat = "count") +
  geom_text(aes(label=scales::percent(round(..prop..,2)), 
                y=..prop..), stat= "count", color = "white", size = 3, position = position_stack(vjust = 0.5)) +
  scale_y_continuous(labels = scales::percent_format()) +
  labs(x = "País", title = "Proporção de participantes em cada país investigado")
```

O gráfico de setor (as vezes chamado de polar, pizza ou torta) também pode ser utilizado. O aspecto principal desse gráfico é apresentar o tamanho dos setores de maneira proporcional às frequências.

```{r}
Dataset %>% 
  count(country) %>% 
  mutate(pct = n/sum(n)) %>% 
  ggplot(., aes(x="", y= pct, fill=country)) +
  geom_col() +
  geom_text(aes(label = scales::percent(round(pct,3))), position = position_stack(vjust = 0.5))+
  coord_polar(theta = "y") +
  labs(title = "Proporção de participantes em cada país")
```


## 1 variável contínua

Quando uma única variável deve ser apresentada e ela é continua, os melhor gráficos são o histograma, densidade (kernel) e o boxplot.

Abaixo um histograma da idade dos participantes:

```{r}
ggplot(Dataset, aes(x = age)) +
  geom_histogram(bins = 30, color = "black", fill = "lightgrey") +
  labs(title = "Distribuição da idade dos participantes")
```

Abaixo um gráfico de densidade da idade:

```{r}
ggplot(Dataset, aes(x = age)) +
  geom_density(fill = "lightgray") +
  labs(title = "Distribuição da idade dos participantes")
```

Todas as distribuições tem uma localização, uma dispersão e um formato. De uma maneira mais direta, tanto o histograma como o gráfico de densidade conseguem informar bem, principalmente, sobre o <u>formato</u> da distribuição. Nesse caso, trata-se de uma assimetria positiva ou à direita. 


Por sua vez, abaixo o boxplot dessa mesma variável: 

```{r}
ggplot(Dataset, aes(y = age, x = "")) +
  geom_boxplot() +
  labs(title = "Distribuição da idade dos participantes")
```

O boxplot apresenta vantagens em comparação com os outros gráficos apresentados até agora. Além de apresentar o formato da distribuição, ele também (1) apresenta na área da caixa a concetração onde 50% dos dados estão, (2) a mediana dos resultados, na linha interna e mais espessa da caixa, (3) os valores mínimos e máximos e (4) os eventuais outliers. É importante notar que a parte inferior da caixa é formada pelo valor do primeiro quartil (Q1), a linha mais espessa interna apresenta o segundo quartil (Q2) ou a mediana e a parte superior da caixa apresenta o valor do terceiro quartil (Q3). Os bigodes são frequentemente construídos com base em `Q1 - 1.5*IQR` e `Q3 + 1.5*IQR` e valores acima ou abaixo dele são entendidos como anômalos ou outliers. Por definição, os outliers são sempre poucos, mesmo que isso possa ser um pouco contraintuitivo nesta apresentação de agora. 

O gráfico abaixo apresenta parte dos valores descritos.   

```{r}
ggplot(Dataset, aes(y = age, x = "")) +
  geom_boxplot()  +
  stat_summary(
    aes(label=sprintf("%1.1f", ..y..)),
    geom="text", 
    fun = function(y) boxplot.stats(y)$stats,
    position=position_nudge(x=0.5), 
    size=3.5)
```

Apesar de ser um pouco difícil de se visualizar ao início, a informação apresentada em um boxplot e no histograma ou gráfico densidade são virtualmente as mesmas, tal como demonstrado a seguir.   

```{r}
gridExtra::grid.arrange(
  #Grafico 1
  ggplot(Dataset, aes(x = age)) +
  geom_density(fill = "lightgray") + labs(x="", y=""),
  #Grafico 2
  ggplot(Dataset, aes(y = age, x = "")) +
  geom_boxplot() + labs(x = "") +
  coord_flip(),
  top = "Distribuição da idade dos participantes" #título
)
```


## 2 variáveis com VI discreta (e VD contínua)  

Gráficos de barras ou colunas e boxplots são adequados para apresentar essa relação. Basicamente, esses gráficos permitem verificar a <u>diferença</u> entre os grupos. 

Como exemplo, o gráfico abaixo mostra os resultados do Inventário Beck de Ansiedade entre 3 países investigados. 

```{r}
ggplot(Dataset, aes(x = country, y = bai_sum)) +
  geom_bar(stat = "summary", fun = mean) 
```

Tal como apresentado no início do capítulo, é possível adicionar outros elementos ao gráfico para que uma primeira apreensão inferencial seja possível. Nesse sentido, o gráfico abaixo apresenta também as barras de erro.


```{r}
ggplot(Dataset, aes(x = country, y = bai_sum)) +
  geom_bar(stat = "summary", fun = mean) +
  stat_summary(geom = "errorbar",fun.data = mean_se, width = .5) 
```

O boxplot a seguir também é um gráfico indicado. É importante notar que esse gráfico, a priori, <u>não</u> traz informações sobre a média, mas sim sobre a <u>distribuição</u> dos resultados. Evidentemente, como esse gráfico é bastante compreensivo, uma primeira noção inferencial já pode ser feita.   

```{r}
ggplot(Dataset, aes(x = country, y = bai_sum)) +
  geom_boxplot()
```


## 2 variáveis com VI contínua (e VD contínua)  

Quando tanto a VI como a VD são contínuas, o gráfico de pontos e de dispersão são indicados. Eles são virtualmente identicos e ajudam a verificar a <u>associação</u> entre as variáveis. No `ggplot`, o argumento `geom_point` (à esquerda) e `geom_jitter` (à direita) são possíveis. 

```{r}
gridExtra::grid.arrange(
  #Grafico 1
  ggplot(Dataset, aes(x = age, y = bai_sum)) +
  geom_point(),
  
  #Grafico 2
  ggplot(Dataset, aes(x = age, y = bai_sum)) +
  geom_jitter(),
  nrow=1
)
```


De maneira análoga às barras de erros apresentadas em gráficos com VIs são discretas, reta de regressão amostral (FRA) costumem ser adicionadas em gráficos em que a VI é contínua. A seguir, segue um exemplo. No capítulo sobre modelos de regressão, esse conceito será novamente revisitado.  

```{r}
ggplot(Dataset, aes(x = age, y = bai_sum)) +
  geom_jitter() +
  geom_smooth(method = "lm")
```

## Outros gráficos e configurações

É possível construir gráficos com diversas variáveis, desde que elas sejam relacionadas ao problema de pesquisa estudado e nem sobrecarreguem, nem distorçam a visualização e entendimento dos resultados. Frequentemente, as informações adicionais são feitas pela inclusão de <u>clusters</u> ou <u>agrupamentos</u>. Isso é tanto possível em gráficos cuja VI seja discreta quanto contínua.

No exemplo abaixo, o gráfico dos resultados do Inventário Beck de Ansiedade entre os 3 países investigados (VI discreta) agora está agrupado pelo sexo do participante.

```{r}
Dataset %>% 
  filter(!is.na(sex)) %>% 
  ggplot(., aes(x = country, y = bai_sum, fill = sex)) +
  geom_bar(stat = "summary", position = "dodge") +
  stat_summary(geom="errorbar", fun.data = mean_se, position = position_dodge(0.95), width = .5) 
```
Repare que este gráfico traz uma informação importante sobre os resultados de homens e mulheres nos três países. Além disso, as barras de erro ajudam em um primeiro entendimento de possíveis diferenças significativas. Esse conceito irá ser revisitado em capítulos subsequentes.  
Já no exemplo abaixo, a relação entre idade e pontuação no Inventário Beck de Ansiedade está agora agrupada pelo sexo do participante.

```{r}
Dataset %>% 
  filter(!is.na(sex)) %>% 
  ggplot(., aes(x = age, y = bai_sum, color = sex)) +
  geom_jitter() +
  geom_smooth(method = "lm") 
```
Neste gráfico de agora, é possível perceber que os a relação entre a idade e os resultados do Inventário Beck de Ansiedade é muito pequena tanto para homens como para mulheres. Especialmente no capítulo de correlação, esse assunto será revisitado e parte dos termos utilizados aqui será alterado.  

Por sua vez, situações em que há uma grande quantidade de variáveis apresentadas tendem a tornar os resultados difíceis de serem entendidos. O gráfico abaixo tenta traduzir essa condição, criando uma visualização de difícil entendimento justamente pelo excesso de variáveis presentes. 

```{r}
Dataset %>% 
  filter(!is.na(sex)) %>% 
  ggplot(., aes(x = age, y = bai_sum, color = sex, shape = country)) +
  geom_jitter() +
  geom_smooth(method = "lm") 
```

Espera-se que seja possível constantar que este gráfico é <mark>totalmente inadequado</mark>, já que é carregado por informações, permite um baixo entendimento dos resultados da pesquisa e, eventualmente, pode gerar conclusões incorretas ou viesadas.  

## Execução no JASP  

Da mesma forma que feito no R, será necessário carregar a {base}(https://osf.io/e639b/) para o JASP. 


## Tabelas  

Após ter a base disposta no JASP, para gerar tabelas e gráficos, será necessário acessar a opção `Descriptives`. O JASP tratará todas as variáveis com um símbolo de diagrama de venn ou barras como categórias e todas as variáveis com símbolo de régua como contínuas.  

![](./img/cap_desc_jasp_descritivo.png)
  
Ao clicar nesta opção, será possível eleger as variáveis que irão ser analisadas e as variáveis que irão funcionar como agrupadores. Na prática, quando há duas ou mais variáveis para serem analisadas, a lista `Variables` irá reunir as variáveis dependentes, enquanto a variável independente será colocada na seção `Split`. É importante atentar à opção `Frequency tables (nominal and ordinal)`, que deve ser marcada quando o nível de medida da variável de interesse for nominal ou ordinal. 



![](./img/cap_desc_jasp_descritivo2.png)

Isto posto, vamos reproduzir parcialmente as mesmas análises feitas no ambiente R. Inicialmente, uma tabela descrevendo os participantes em cada um dos país é importante para apresentar ao leitor algumas das principais características da amostra. Para fazer isso, será necessário levar a variável <u>country</u> para a seção `Variables` e clicar em `Frequency tables (nominal and ordinal)`.


![](./img/cap_desc_jasp_proporcao.png)

Por padrão o JASP irá apresentar as contagens (frequências absolutas) e as proporções. A parte mais esquerda da tabela descreverá os dados considerando todos os valores presentes na base. A parte mais à direita irá apresentar apenas os dados válidos, que <u>não consideram casos ausentes</u>. É importante antentar que o JASP <u>não</u> exclui estes casos, mas apenas não os mostra.


Para verificar a frequência e a proporção de homens e mulheres na amostra, será necessário colocar também a variável <u>sex</u> na opção `Variables`. Não é preciso retirar a variável <u>country</u> antes de fazer isso. O JASP irá apresentar ambas as tabelas de maneira empilhada.


![](./img/cap_desc_jasp_proporcao_duas_variaveis.png)


Para fazer uma tabela agrupando tanto <u>country</u>, como <u>sex</u>, é necessário arrastar a variável que será apresentada nas linhas para o espaço `Split`. Em uma tabela em que se descreve a contagem e porcentagem de homens e mulheres em cada um dos três países de maneira independente, é necessário preencher o `Split` com a variável <u>country</u>. O JASP aceita que se arraste a variável de um local para o outro e, ao fazer isso, todas as contas serão automaticamente atualizadas.

![](./img/cap_desc_jasp_proporcao_duas_variaveis_split.png) 

É possível perceber que as variáveis categóricas são descritas por suas frequências e proporções. Por sua vez, variáveis contínuas costumam ser resumidas por medidas de posição e dispersão, tal como a média e o desvio-padrão. Como exemplo, para calcular tais medidas estatísticas dos valores do BDI e do BAI em função do país do participante, é necessário deixar a variável <u>country</u> em `Split` e levar as variáveis <u>bdi_sum</u> e <u>bai_sum</u> para `Variables`. 

![](./img/cap_desc_jasp_proporcao_duas_variaveis_split2.png) 

Dessa vez, não é necessário ativar a opção `Frequency tables (nominal and ordinal)`. O símbolo de régua ao lado das variáveis <u>bdi_sum</u> e <u>bai_sum</u> indicadom de que elas são contínuas. O símbolo de diagrama de Venn ao lado de <u>country</u>, por sua vez, indica que ela é categórica.


Para fazer essas análises considerando <u>sex</u> como agrupador, será necessário substituir <u>country</u> por <u>sex</u> no espaço de `Split`.

![](./img/cap_desc_jasp_proporcao_duas_variaveis_split3.png) 

Nesta versão do JASP, não é possível colocar duas variáveis como agrupadoras. Dessa maneira, a reprodução das tabelas feitas anteriormente no ambiente R é apenas parcial.  

## Gráficos

O JASP é um exelente programa para gerar gráficos. Tal como previamente apresentado, a criação de um gráfico apropriado dependerá tanto da quantidade de variáveis que devem ser apresentadas, como do nível de medida da VI, especialmente em análises bi ou multivariadas.  O JASP pode fazer gráficos tanto seção `Descriptives` como em após análise de dados específicas. Na seção `Descriptives`, será necessário primeiro arrastar as variáveis de interesse para seus respectivos lugares e, em seguida, clicar na opção `Plot`.


![](./img/cap_desc_jasp_graficos.png) 




## 1 variável discreta

Para este tipo de variável, gráfico de barras, colunas e setor são indicados. Para realizar um gráfico de barras, é necessário colocar a variável de interesse em `Variables` e, dentro de `Plots`, clicar em `Distribuition plots`. O JASP organiza as barras de ordem crescente. 


![](./img/cap_desc_jasp_grafico_barras.png)

Para realizar um gráfico de setor, basta selecionar a opção `Pie Charts`. A visualização ocorrerá automaticamente. Uma vantagem deste gráfico é a apresentação proporção do elementos gráficos, em vez de contagens. Infelizmente, nesta versão do JASP, não é possível adicionar um rótulo com a porcentagem de cada cateogoria.  


![](./img/cap_desc_jasp_grafico_setor.png)


O JASP permite customizar as cores de alguns gráficos. Para fazer isso, basta clicar em `Color Palette` e escolher entre as opções disponíveis. Existem algumas possibilidade e recomendo optar por aquelas que permitem que pessoas com limitações visuais possam também se beneficiar. Entretanto, apenas como demonstração, o tema `ggplot2` é apresentado abaixo.  

![](./img/cap_desc_jasp_grafico_setor2.png)

## 1 variável discreta  

Histogramas, gráficos de densidade e boxplots costumam ser indicados para variáveis discretas. Para o JASP fazer tais gráficos, é necessário que o espaço `Variables` seja preenchido por alguma variável que tenha o símbolo da régua ao lado. A variável <u>age</u> é um bom exemplo. Ao colocá-la neste local e marcar a opção `Distribution plots`, um histograma será automaticamente apresentado.  


![](./img/cap_desc_jasp_grafico_histograma.png)


É possível adicionar a densidade de maneira sobreposta ao histograma clicando em `Display density`.

![](./img/cap_desc_jasp_grafico_densidade.png)

Por sua vez, o boxplot pode ser criado ao clicar na opção `Boxplots` e, em seguida, `Boxplot element`. 


![](./img/cap_desc_jasp_grafico_boxplot.png)


Customizar o boxplot é possível, bem como adicionar outros gráficos que vem sendo mais utilizados recentemente, como o gráfico de violino.  Isso não será demonstrado aqui, mas para fazer isso, basta ativar as opções desejadas na seção `Customizable plots`.

Tal como discutido anteriormente, O boxplot apresenta vantagens em comparação com os outros gráficos apresentados até agora. Além de apresentar o formato da distribuição, ele também (1) apresenta na área da caixa a concetração onde 50% dos dados estão, (2) a mediana dos resultados, na linha interna e mais espessa da caixa, (3) os valores mínimos e máximos e (4) os eventuais outliers. É importante notar que a parte inferior da caixa é formada pelo valor do primeiro quartil (Q1), a linha mais espessa interna apresenta o segundo quartil (Q2) ou a mediana e a parte superior da caixa apresenta o valor do terceiro quartil (Q3). Os bigodes são frequentemente construídos com base em `Q1 - 1.5*IQR`  e `Q3 + 1.5*IQR` e valores acima ou abaixo dele são entendidos como anômalos ou outliers. Por definição, os outliers são sempre poucos, mesmo que isso possa ser um pouco contraintuitivo nesta apresentação de agora.



## 2 variáveis com VI discreta (e VD contínua)

Para situações em que há duas variáveis, a VI é tratada como discreta e a VD é contínua, gráficos de barras, colunas ou boxplots são indicados. Nesta versão do JASP, apenas o boxplot pode ser feito. Para verificar, por exemplo, a distribuição dos resultados do <u>bai_sum</u> em função do <u>país</u>, é necessário levar às variáveis a seus respectivos locais e, em seguida, o JASP permite realizar o boxplot.  

![](./img/cap_desc_jasp_grafico_boxplot_grupo.png)


## 2 variáveis com VI contínua (e VD contínua)

Quando há duas variáveis contínuas, tanto o gráfico de pontos como de dispersão são possíveis. Para fazer isso, é necessário incluir ambas as variáveis de interesse em `Variables`. Por exemplo, <u>age</u> e <u>bai_sum</u>.

![](./img/cap_desc_jasp_grafico_scatter1.png)

É tanto possível marcar a opção `Scatter Plots`, como a opção `Correlation Plots`.

![](./img/cap_desc_jasp_grafico_scatter2.png)

A escolha de cada opção é relacionada com os elementos que devem (ou não) serem incluídos neste gráfico. Na opção `Scatter Plot`, o gráfico irá exibir os pontos dos respectivos pares ordenados das variáveis x e y, suas densidade e também adicionar uma reta de regressão. Este último conceito será revisitado no capítulo de regressão. Um aspecto visualmente importante é a eleição de qual variável irá em x. Com bastante frequência, deve-se inserir a VI (mesmo que teórica) em x, enquanto a VD em y. Isso é feito alterando a ordem das variáveis em `Variables`. 


![](./img/cap_desc_jasp_grafico_scatter3.png)

## Outros gráficos e configurações

O JASP é bastante versátil na realização de gráficos e permite que mais variáveis sejam inseridas. Há também um módulo (`Module`) chamado `Visual Modeling`, que permite uma grande customização de gráficos. Para acessá-lo, é necessário clicar na cruz azul, tal como destacado abaixo no quadrado roxo.

![](./img/cap_desc_jasp_modules.png)

Na lista de opções, é necessário ativar `Visual Modeling`. Ao fazer isso, o icone será ativado na barra de ferramentas. 


![](./img/cap_desc_jasp_visual_modeling.png)

Com isso feito, dentro de `Visual Modeling`, a opção `Flexplot` adiciona uma melhora substancial aos gráficos que o JASP executa. Agora é possível, por exemplo, fazer um gráfico incluindo um <u>cluster</u> ou <u>agrupamento</u>, em que os resultados do Inventário Beck de Ansiedade sejam apresentados tanto em função dos países investigados, como do seo do participante.


![](./img/cap_desc_jasp_flexplot.png)


Uma série de outras opções e combinações podem ser feitas ao clicar em `Options` e `Plot Labels`. Elas não serão apresentadas nesta seção.


## Resumo  

Este capítulo apresentou os aspectos tabulares e gráficos corriqueiramente encontrados em pesquisas de Psicologia e áreas congêneres. Entre os pontos principais, estão os seguintes:  

1. Medidas de posição e dispersão são fundamentais na apresentação dos resultados de uma pesquisa   
2. A média e o desvio-padrão são, respectivamente, as medidas de posição e dispersão mais utilizadas   
3. Tabelas e gráficos visam informar o leitor, sem criar viés ou distorção dos resultados  
4. As tabelas são muito úteis para uma apresentação mais detalhada dos resultados  
5. Gráficos condensam um grande volume de dados de uma forma mais facilmente interpretável    
6. A heurística típica em gráficos solicita responder a quantidade e a natureza das variáveis a serem apresenadas   

## Pesquisas adicionais  


